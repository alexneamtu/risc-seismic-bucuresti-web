$g: #efefef;
$b: #eb5158;
$bl: #c4e4e4;
$gr: #a6cd52;
$t: transparent;
$g2: #555;

#wrap{
  pointer-events:none;
  display:grid;
  width:100%;
  max-width: 500px;
  height:500px;
  position:relative;
  transform:rotateX(65deg) translateY(250px) scale(0.75);
  transition:1s ease-in-out;
  position: absolute;
  transform-style:preserve-3d;
  margin-top: 40px;

  @media (max-width: 720px) {
    left: -25%;
  }

  *{
    transform-style:preserve-3d;

    &:before, &:after{
      transform-style:preserve-3d;
    }
  }

  .cell{
    position:absolute;
    height:2.5vh;
    z-index:999;
    cursor:pointer;
    &:focus, &:active{
      ~ #wrap .plane .body .wrap{
        transform:rotateZ(720deg);
      }
    }

    @for $i from 1 through 40{
      &:nth-of-type(#{$i}){
        top:#{($i - 1) * 2.5}vh;
        &:hover{
          & ~ #wrap{
            transform:rotateX(#{70 - $i}deg) translateY(#{250 - ($i * 5)}px) scale(0.75);
            transition:0.2s linear;
          }
        }
      }
    }
  }

  .inner{
    position:absolute;
    width:100%;
    height:100%;
    top:0;
    left:0;
    animation:spin 15s linear infinite;
    &:before{
      content:'';
      position:fixed;
      width:100%;
      height:100%;
      left:0;
      top:0;
      box-shadow: 0 0 0 20px #999, inset 0 0 0 20px #555;
      background-color: #6f9029;
      background-size:85% 100%, 100% calc(100% - 440px), 100% calc(100% - 100px), 85% 100%, 100%;
      background-repeat:no-repeat;
      border-radius:60px;
    }
    @keyframes spin{
      to{
        transform:rotate(360deg);
      }
    }
  }
  .cell{
    position:absolute;
    width:100px;
    height:100px;
    left:calc(50% - 50px);
    top:calc(50% - 50px);
    --color:22, 40%;
    --l:60%;
    .side{
      &:before, &:after{
        content:'';
        position:absolute;
        width:90%;
        height:90%;
        left:5%;
        top:0%;
        background:inherit;
        mask:repeating-linear-gradient(to bottom, #fff 10px, $t 10px, $t 20px, #fff 20px, #fff 30px), repeating-linear-gradient(to right, #fff 10px, $t 10px, $t 20px, #fff 20px, #fff 30px);
        z-index:2;
      }
      &:after{
        mask:none;
        background:repeating-linear-gradient(to bottom, $t 10px, $t 10px, $t 19px, var(--color-primary-darker) 19px, $t 30px), lighten($bl, 10%);
        z-index:0;
      }

      &:last-of-type{
        &:before, &:after{
          background:var(--color-primary);
          width:90%;
          height:90%;
          left:5%;
          top:5%;
          mask:none;
        }
      }
    }
    &:nth-of-type(1){
      left:50px;
      top:50px;
      transform:scale(0.65);
      --color:162, 40%;
      --l:70%;
      .side{
        height:300%;
        &:last-of-type{
          transform:translateZ(299px);
        }
      }
    }
    &:nth-of-type(2){
      left:250px;
      top:50px;
      transform:scale(0.75);
      --color:82, 10%;
      --l:80%;
      .side{
        height:250%;
        &:last-of-type{
          transform:translateZ(248px);
        }
      }
    }
    &:nth-of-type(3){
      left:360px;
      top:300px;
      transform:scale(0.85);
      --color:52, 60%;
      --l:80%;
      .side{
        height:250%;
        &:last-of-type{
          transform:translateZ(248px);
        }
      }
    }
    &:nth-of-type(4){
      left:200px;
      top:350px;
      --color:122, 10%;
      --l:90%;
      .side{
        height:150%;
        &:before, &:after{
          height:70%;
        }
        &:last-of-type{
          transform:translateZ(148px);
          &:before, &:after{
            height:90%;
          }
        }
      }
    }
    &:nth-of-type(5){
      left:0px;
      top:290px;
      --color:62, 40%;
      --l:90%;
      .side{
        height:200%;
        &:last-of-type{
          transform:translateZ(199px);
        }
      }
    }
    .side{
      position:absolute;
      height:400%;
      width:100%;
      bottom:0;
      left:0;
      animation:darken 15s linear infinite;
      --color-primary: hsl(var(--color),var(--l));
      --color-primary-darker: hsl(var(--color),calc(var(--l) - 20%));
      --color-primary-darkest: hsl(var(--color),calc(var(--l) - 50%));
      --color-primary-lighter: hsl(var(--color),calc(var(--l) - -5%));
      @keyframes darken{
        0%{
          background:var(--color-primary);
        }
        50%{
          background:var(--color-primary-darkest);
        }
        100%{
          background:var(--color-primary);
        }
      }
      &:nth-of-type(1){
        transform-origin:bottom;
        transform:rotateX(-90deg);
        animation-delay:0s;
      }
      &:nth-of-type(2){
        transform-origin:0% 100%;
        transform:rotateX(-90deg) rotateY(270deg) translateX(-100%);
        animation-delay:-3.75s;
      }
      &:nth-of-type(3){
        transform-origin:bottom;
        transform:rotateX(-90deg) rotateY(180deg);
        bottom:100%;
        animation-delay:-7.5s;
      }
      &:nth-of-type(4){
        transform-origin:100% 100%;
        transform:rotateX(-90deg) rotateY(90deg) translateX(100%);
        animation-delay:-11.25s;
      }
      &:nth-of-type(5){
        background:var(--color-primary-darker);
        animation:none;
        height:100%;
        width:100%;
        transform:translateZ(399px);
      }
    }
  }
}